<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>python+pyqt5制作小初考倒计时</title>
    <url>/2023/05/06/python+pyqt5%E5%88%B6%E4%BD%9C%E5%B0%8F%E5%88%9D%E8%80%83%E5%80%92%E8%AE%A1%E6%97%B6/</url>
    <content><![CDATA[<p>马上要小初考了，做个倒计时提醒自己。<br>(需要下载pyqt5 下载指令:pip install pyqt5<br>如果下载慢用清华源：pip config set global.index-url <a href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a>)</p>
<p>(Countdown.py)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> exit ,argv</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtWidgets <span class="keyword">import</span> QApplication,QMessageBox,QWidget,QLabel,QLCDNumber,QAction,QMenu,QInputDialog,QLineEdit,QDesktopWidget,QSystemTrayIcon</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtCore <span class="keyword">import</span> QTimer,Qt</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtGui <span class="keyword">import</span>  QPixmap, QPainter,QPaintEvent,QIcon,QPainterPath</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">myWindow</span>(<span class="title class_ inherited__">QWidget</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,parent=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(parent)</span><br><span class="line">        self.time_2 = <span class="string">&#x27;2023-06-17 08:00:00&#x27;</span></span><br><span class="line">        self.desktop = QApplication.desktop()</span><br><span class="line">        self.screenRect = self.desktop.screenGeometry()</span><br><span class="line">        self.screenheight = self.screenRect.height()</span><br><span class="line">        self.screenwidth = self.screenRect.width()</span><br><span class="line"></span><br><span class="line">        self.height_ = <span class="built_in">int</span>(self.screenheight * <span class="number">0.39</span>)</span><br><span class="line">        self.width_ = <span class="built_in">int</span>(self.screenwidth * <span class="number">0.395</span>)</span><br><span class="line">        self.resize(self.width_,self.height_)</span><br><span class="line">        </span><br><span class="line">        self.setWindowFlags(Qt.SubWindow|Qt.FramelessWindowHint|Qt.FramelessWindowHint|Qt.WindowStaysOnBottomHint)</span><br><span class="line">        self.label = QLabel(<span class="string">&quot;距离小升初考大概还有：\n(&#123;&#125;)\n  (天) (时) (分) (秒)&quot;</span>.<span class="built_in">format</span>(self.time_2),self)</span><br><span class="line">        self.labeltext = QLabel(<span class="string">&#x27;&#x27;</span>,self)</span><br><span class="line"></span><br><span class="line">        screen = QDesktopWidget().screenGeometry()</span><br><span class="line">        size = self.geometry()</span><br><span class="line">        newLeft = (screen.width() - size.width())/<span class="number">2</span></span><br><span class="line">        self.move(<span class="built_in">int</span>(newLeft),<span class="number">0</span>)</span><br><span class="line">        font = self.label.font()</span><br><span class="line">        font.setPointSize(<span class="number">30</span>)</span><br><span class="line">        font.setFamily(<span class="string">&quot;HYWenHei-55W&quot;</span>)</span><br><span class="line">        fonttext = self.labeltext.font()</span><br><span class="line">        fonttext.setFamily(<span class="string">&quot;HYWenHei-55W&quot;</span>)</span><br><span class="line">        fonttext.setPointSize(<span class="number">18</span>)</span><br><span class="line">        self.label.setFont(font)</span><br><span class="line">        self.label.setGeometry(<span class="built_in">int</span>(self.screenwidth * <span class="number">0.05</span>),<span class="number">0</span>,<span class="built_in">int</span>(self.screenwidth * <span class="number">0.5</span>),<span class="built_in">int</span>(self.screenheight* <span class="number">0.2</span>))</span><br><span class="line">        self.labeltext.setFont(fonttext)</span><br><span class="line">        self.labeltext.setGeometry(<span class="built_in">int</span>(self.screenwidth * <span class="number">0.05</span>),<span class="built_in">int</span>(self.screenheight* <span class="number">0.25</span>),<span class="built_in">int</span>(self.screenwidth * <span class="number">0.5</span>),<span class="built_in">int</span>(self.screenheight* <span class="number">0.2</span>))</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        self.icon=QIcon(<span class="string">&#x27;./R-C.ico&#x27;</span>)</span><br><span class="line">        Style = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        QMenu &#123;</span></span><br><span class="line"><span class="string">            background-color: rgba(255, 255, 255, 230);</span></span><br><span class="line"><span class="string">            border: none;</span></span><br><span class="line"><span class="string">            border-radius: 4px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        QMenu::item &#123;</span></span><br><span class="line"><span class="string">            border-radius: 4px;</span></span><br><span class="line"><span class="string">            padding: 8px 48px 8px 36px; </span></span><br><span class="line"><span class="string">            background-color: transparent;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        QMenu::item:selected &#123;</span></span><br><span class="line"><span class="string">            border-radius: 0px;</span></span><br><span class="line"><span class="string">            background-color: rgba(232, 232, 232, 232);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        QMenu::item:disabled &#123;</span></span><br><span class="line"><span class="string">            background-color: transparent;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        QMenu::icon &#123;</span></span><br><span class="line"><span class="string">            left: 15px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        QMenu::separator &#123;</span></span><br><span class="line"><span class="string">            height: 1px;</span></span><br><span class="line"><span class="string">            background-color: rgb(232, 236, 243);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.tray = QSystemTrayIcon()</span><br><span class="line">        self.tray.setIcon(self.icon)</span><br><span class="line">        self.tray.setToolTip(<span class="string">&quot;Countdown&quot;</span>)</span><br><span class="line">        showAction = QAction(<span class="string">&quot;显示&quot;</span>, self, triggered = self.show)</span><br><span class="line">        hideAction = QAction(<span class="string">&quot;隐藏&quot;</span>, self, triggered = self.hide)</span><br><span class="line">        updateAction = QAction(<span class="string">&quot;重新加载窗口&quot;</span>, self, triggered = self.update)</span><br><span class="line">        openiniAction = QAction(<span class="string">&quot;重新加载配置文件&quot;</span>, self, triggered = self.openini)</span><br><span class="line">        quitAction = QAction(<span class="string">&quot;退出&quot;</span>, self, triggered = self.quit_app)</span><br><span class="line">        self.trayMenu = QMenu(self)</span><br><span class="line">        self.trayMenu.setAttribute(Qt.WA_TranslucentBackground)</span><br><span class="line">        self.trayMenu.setStyleSheet(Style)</span><br><span class="line"></span><br><span class="line">        self.trayMenu.setWindowFlags(self.trayMenu.windowFlags() | Qt.FramelessWindowHint | Qt.NoDropShadowWindowHint)</span><br><span class="line">        self.trayMenu.addAction(QAction(<span class="string">&quot;Countdown&quot;</span>, self))</span><br><span class="line">        self.trayMenu.addAction(showAction)</span><br><span class="line">        self.trayMenu.addAction(hideAction)</span><br><span class="line">        self.trayMenu.addAction(updateAction)</span><br><span class="line">        self.trayMenu.addAction(openiniAction)</span><br><span class="line">        self.trayMenu.addAction(quitAction)</span><br><span class="line">        self.tray.setContextMenu(self.trayMenu)</span><br><span class="line">        self.tray.show()</span><br><span class="line"></span><br><span class="line">        self.lcdNumber = QLCDNumber(<span class="number">15</span>,self)</span><br><span class="line">        self.lcdNumber.setLineWidth(<span class="number">0</span>)</span><br><span class="line">        self.lcdNumber.setGeometry(<span class="built_in">int</span>(self.screenwidth * <span class="number">0.05</span>),<span class="built_in">int</span>(self.screenheight* <span class="number">0.15</span>),<span class="built_in">int</span>(self.screenwidth * <span class="number">0.3</span>),<span class="built_in">int</span>(self.screenheight* <span class="number">0.2</span>))</span><br><span class="line">        self.timer = QTimer(self)</span><br><span class="line">        self.lcdNumber.display(<span class="string">&#x27;88:88:88:88  &#x27;</span>)</span><br><span class="line">        self.timer.setInterval(<span class="number">1000</span>)</span><br><span class="line">        self.timer.timeout.connect(self.change)</span><br><span class="line">        self.timer.start()</span><br><span class="line">        self.openini()</span><br><span class="line">        self.show()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">quit_app</span>(<span class="params">self</span>):</span><br><span class="line">        text , ok = QInputDialog.getText(self,<span class="string">&quot;关闭窗口&quot;</span>,<span class="string">&quot;请输入密码关闭窗口：&quot;</span>,QLineEdit.Password)</span><br><span class="line">        <span class="keyword">if</span> ok:</span><br><span class="line">            <span class="keyword">if</span> text==<span class="string">&#x27;@royi123456&#x27;</span>:</span><br><span class="line">                self.tray==<span class="literal">None</span></span><br><span class="line">                self.icon==<span class="literal">None</span></span><br><span class="line">                self.close()</span><br><span class="line">                QMessageBox.information(self, <span class="string">&quot;Countdown&quot;</span>, <span class="string">&quot;密码正确 点击OK关闭&quot;</span>)</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                QMessageBox.critical(self,<span class="string">&quot;Countdown&quot;</span>, <span class="string">&quot;密码错误&quot;</span>)</span><br><span class="line">                self.quit_app()</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">openini</span>(<span class="params">self</span>):</span><br><span class="line">        f=<span class="literal">None</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;Countdown.ini&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            line=f.readlines()</span><br><span class="line">            self.color=line[<span class="number">0</span>].strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            self.text=line[<span class="number">1</span>].strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            self.bg=line[<span class="number">2</span>].strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            self.hideshow=line[<span class="number">3</span>].strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        self.label.setStyleSheet(<span class="string">&quot;color:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.color))</span><br><span class="line">        self.labeltext.setStyleSheet(<span class="string">&quot;color:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.color))</span><br><span class="line">        self.labeltext.setText(self.text)</span><br><span class="line">        self.lcdNumber.setStyleSheet(<span class="string">&quot;color:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.color))</span><br><span class="line"></span><br><span class="line">        self.update()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">paintEvent</span>(<span class="params">self, a0: QPaintEvent</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        painter = QPainter(self)</span><br><span class="line">        pixmap = QPixmap(<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self.bg))</span><br><span class="line">        painter.drawPixmap(self.rect(), pixmap)</span><br><span class="line">        path = QPainterPath()</span><br><span class="line">        path.setFillRule(Qt.WindingFill)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enterEvent</span>(<span class="params">self, e</span>):</span><br><span class="line">        <span class="keyword">if</span> self.hideshow ==<span class="string">&#x27;True&#x27;</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                self.setWindowOpacity (<span class="number">1</span>-i/<span class="number">10</span>)</span><br><span class="line">                sleep(<span class="number">0.01</span>)</span><br><span class="line">            self.setWindowOpacity (<span class="number">0.005</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">leaveEvent</span>(<span class="params">self, e</span>):</span><br><span class="line">        <span class="keyword">if</span> self.hideshow ==<span class="string">&#x27;True&#x27;</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                self.setWindowOpacity (<span class="number">0</span>+i/<span class="number">10</span>)</span><br><span class="line">                sleep(<span class="number">0.01</span>)</span><br><span class="line">            self.setWindowOpacity (<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">self</span>):</span><br><span class="line">        time_1 = datetime.now()</span><br><span class="line">        time_2_struct = datetime.strptime(self.time_2, <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">        seconds = (time_2_struct - time_1).seconds</span><br><span class="line">        string =<span class="string">&#x27;&#123;:02d&#125;:&#123;:02d&#125;:&#123;:02d&#125;:&#123;:02d&#125;  &#x27;</span>.<span class="built_in">format</span>((time_2_struct - time_1).days,seconds//<span class="number">3600</span>,seconds%<span class="number">3600</span>//<span class="number">60</span>,seconds%<span class="number">60</span>)</span><br><span class="line">        self.lcdNumber.display(string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app=QApplication(argv)</span><br><span class="line">    window = myWindow()</span><br><span class="line">    n= app.<span class="built_in">exec</span>()</span><br><span class="line">    exit(n)</span><br></pre></td></tr></table></figure>

<p>上面是源代码<br>运行后会报错:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;xxx\Countdown.py&quot;</span>, line <span class="number">161</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    window = myWindow()</span><br><span class="line">  File <span class="string">&quot;xxx\Countdown.py&quot;</span>, line <span class="number">103</span>, <span class="keyword">in</span> __init__</span><br><span class="line">    self.openini()</span><br><span class="line">  File <span class="string">&quot;xxx\Countdown.py&quot;</span>, line <span class="number">121</span>, <span class="keyword">in</span> openini</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;Countdown.ini&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">FileNotFoundError: [Errno <span class="number">2</span>] No such file <span class="keyword">or</span> directory: <span class="string">&#x27;Countdown.ini&#x27;</span></span><br></pre></td></tr></table></figure>
<p>翻译一下就是找不到’Countdown.ini’<br>所以要在’Countdown.py’同一目录下添加’Countdown.ini’</p>
<p>(Countdown.ini)</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">#ffffff</span><br><span class="line">星光不问赶路人，时间不负有心人。</span><br><span class="line">./xxx.jpg</span><br><span class="line">False</span><br></pre></td></tr></table></figure>

<p>可以按以下方法配置<br>(#ffffff)是文字颜色<br>(星光不问赶路人，时间不负有心人。)是祝福语<br>(./xxx.jpg)背景图片<br>(False)鼠标放上去是否隐藏</p>
<p>图片一定要选择！！！</p>
<p>后面点击下面链接下载字体文件</p>
<p><a href="https://royi-jiang.github.io/download/HYWenHei-55W.ttf" title="点击下载">点击下载</a><br>(好慢… 在后面下载压缩包吧)</p>
<p>就可以运行了</p>
<p>源代码压缩包<a href="https://royi-jiang.github.io/download/Countdown.rar" title="点击下载">点击下载</a></p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>教程</tag>
        <tag>pyqt5</tag>
      </tags>
  </entry>
  <entry>
    <title>python连点教程</title>
    <url>/2023/02/06/python%E8%BF%9E%E7%82%B9%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<p>我做了连点和快速输入,有连点、颜色、调用三个文件</p>
<p>下面是代码.</p>
<p>连点：(liandian.py)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui <span class="keyword">as</span> pag</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep,time</span><br><span class="line"><span class="keyword">from</span> color <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> system</span><br><span class="line">__all__ = [<span class="string">&quot;__init__&quot;</span>,<span class="string">&quot;mouse&quot;</span>,<span class="string">&quot;key&quot;</span>,<span class="string">&quot;api&quot;</span>,<span class="string">&#x27;key_all&#x27;</span>]</span><br><span class="line">key_all = [<span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;`&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;accept&#x27;</span>, <span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;alt&#x27;</span>, <span class="string">&#x27;altleft&#x27;</span>, <span class="string">&#x27;altright&#x27;</span>, <span class="string">&#x27;apps&#x27;</span>, <span class="string">&#x27;backspace&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;browserback&#x27;</span>, <span class="string">&#x27;browserfavorites&#x27;</span>, <span class="string">&#x27;browserforward&#x27;</span>, <span class="string">&#x27;browserhome&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;browserrefresh&#x27;</span>, <span class="string">&#x27;browsersearch&#x27;</span>, <span class="string">&#x27;browserstop&#x27;</span>, <span class="string">&#x27;capslock&#x27;</span>, <span class="string">&#x27;clear&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;convert&#x27;</span>, <span class="string">&#x27;ctrl&#x27;</span>, <span class="string">&#x27;ctrlleft&#x27;</span>, <span class="string">&#x27;ctrlright&#x27;</span>, <span class="string">&#x27;decimal&#x27;</span>, <span class="string">&#x27;del&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;divide&#x27;</span>, <span class="string">&#x27;down&#x27;</span>, <span class="string">&#x27;end&#x27;</span>, <span class="string">&#x27;enter&#x27;</span>, <span class="string">&#x27;esc&#x27;</span>, <span class="string">&#x27;escape&#x27;</span>, <span class="string">&#x27;execute&#x27;</span>, <span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;f10&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;f11&#x27;</span>, <span class="string">&#x27;f12&#x27;</span>, <span class="string">&#x27;f13&#x27;</span>, <span class="string">&#x27;f14&#x27;</span>, <span class="string">&#x27;f15&#x27;</span>, <span class="string">&#x27;f16&#x27;</span>, <span class="string">&#x27;f17&#x27;</span>, <span class="string">&#x27;f18&#x27;</span>, <span class="string">&#x27;f19&#x27;</span>, <span class="string">&#x27;f2&#x27;</span>, <span class="string">&#x27;f20&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;f21&#x27;</span>, <span class="string">&#x27;f22&#x27;</span>, <span class="string">&#x27;f23&#x27;</span>, <span class="string">&#x27;f24&#x27;</span>, <span class="string">&#x27;f3&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>, <span class="string">&#x27;f5&#x27;</span>, <span class="string">&#x27;f6&#x27;</span>, <span class="string">&#x27;f7&#x27;</span>, <span class="string">&#x27;f8&#x27;</span>, <span class="string">&#x27;f9&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;final&#x27;</span>, <span class="string">&#x27;fn&#x27;</span>, <span class="string">&#x27;hanguel&#x27;</span>, <span class="string">&#x27;hangul&#x27;</span>, <span class="string">&#x27;hanja&#x27;</span>, <span class="string">&#x27;help&#x27;</span>, <span class="string">&#x27;home&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;junja&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;kana&#x27;</span>, <span class="string">&#x27;kanji&#x27;</span>, <span class="string">&#x27;launchapp1&#x27;</span>, <span class="string">&#x27;launchapp2&#x27;</span>, <span class="string">&#x27;launchmail&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;launchmediaselect&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;modechange&#x27;</span>, <span class="string">&#x27;multiply&#x27;</span>, <span class="string">&#x27;nexttrack&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;nonconvert&#x27;</span>, <span class="string">&#x27;num0&#x27;</span>, <span class="string">&#x27;num1&#x27;</span>, <span class="string">&#x27;num2&#x27;</span>, <span class="string">&#x27;num3&#x27;</span>, <span class="string">&#x27;num4&#x27;</span>, <span class="string">&#x27;num5&#x27;</span>, <span class="string">&#x27;num6&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;num7&#x27;</span>, <span class="string">&#x27;num8&#x27;</span>, <span class="string">&#x27;num9&#x27;</span>, <span class="string">&#x27;numlock&#x27;</span>, <span class="string">&#x27;pagedown&#x27;</span>, <span class="string">&#x27;pageup&#x27;</span>, <span class="string">&#x27;pause&#x27;</span>, <span class="string">&#x27;pgdn&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;pgup&#x27;</span>, <span class="string">&#x27;playpause&#x27;</span>, <span class="string">&#x27;prevtrack&#x27;</span>, <span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;printscreen&#x27;</span>, <span class="string">&#x27;prntscrn&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;prtsc&#x27;</span>, <span class="string">&#x27;prtscr&#x27;</span>, <span class="string">&#x27;return&#x27;</span>, <span class="string">&#x27;right&#x27;</span>, <span class="string">&#x27;scrolllock&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;separator&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;shift&#x27;</span>, <span class="string">&#x27;shiftleft&#x27;</span>, <span class="string">&#x27;shiftright&#x27;</span>, <span class="string">&#x27;sleep&#x27;</span>, <span class="string">&#x27;space&#x27;</span>, <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;subtract&#x27;</span>, <span class="string">&#x27;tab&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;up&#x27;</span>, <span class="string">&#x27;volumedown&#x27;</span>, <span class="string">&#x27;volumemute&#x27;</span>, <span class="string">&#x27;volumeup&#x27;</span>, <span class="string">&#x27;win&#x27;</span>, <span class="string">&#x27;winleft&#x27;</span>, <span class="string">&#x27;winright&#x27;</span>, <span class="string">&#x27;yen&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;command&#x27;</span>, <span class="string">&#x27;option&#x27;</span>, <span class="string">&#x27;optionleft&#x27;</span>, <span class="string">&#x27;optionright&#x27;</span>]</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">api</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\nroyi开发&#x27;</span>,FOREGROUND_SKYBLUE)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mouse</span>(<span class="params">self,frequency:<span class="built_in">int</span>,key:<span class="built_in">int</span>,w_time:<span class="built_in">float</span></span>):</span><br><span class="line">        <span class="string">&quot;连点鼠标    frequency:次数(int)    key:左键请输入0,右键输入1(int)    w_time:等待时间(float)&quot;</span></span><br><span class="line">        pag.PAUSE = <span class="number">0</span></span><br><span class="line">        frequency=<span class="built_in">int</span>(frequency)</span><br><span class="line">        key=<span class="built_in">int</span>(key)</span><br><span class="line">        w_time=<span class="built_in">float</span>(w_time)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n请注意：您需要在8秒内将鼠标移动到您需要连点的地方，然后不要动，等待开始快速连点。&#x27;</span>,FOREGROUND_YELLOW)</span><br><span class="line">        sleep(<span class="number">8</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;开始点击！&#x27;</span>,FOREGROUND_YELLOW)</span><br><span class="line">        x,y = pag.position()</span><br><span class="line">        d = <span class="string">&#x27;left&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> key:</span><br><span class="line">            d = <span class="string">&#x27;right&#x27;</span></span><br><span class="line">        e = time()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,frequency):</span><br><span class="line">            pag.click(x,y,button = d)</span><br><span class="line">            sleep(w_time)</span><br><span class="line">        f = time() - e</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;完成。用时%f秒。&#x27;</span> % f,FOREGROUND_SKYBLUE)</span><br><span class="line">        system(<span class="string">&#x27;pause&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">key</span>(<span class="params">self,frequency:<span class="built_in">int</span>,key:<span class="built_in">str</span>,w_time:<span class="built_in">float</span></span>):</span><br><span class="line">        <span class="string">&quot;连按按键    frequency:次数(int)    key:按键名称(str)&quot;</span></span><br><span class="line">        pag.PAUSE = <span class="number">0</span></span><br><span class="line">        frequency=<span class="built_in">int</span>(frequency)</span><br><span class="line">        key=<span class="built_in">str</span>(key)</span><br><span class="line">        w_time=<span class="built_in">float</span>(w_time)</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">in</span> key_all:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\n请注意，您需要在8秒内切换到需要输入的窗口。&#x27;</span>,FOREGROUND_YELLOW)</span><br><span class="line">            sleep(<span class="number">8</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;开始工作！&#x27;</span>,FOREGROUND_YELLOW)</span><br><span class="line">            e = time()</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,frequency):</span><br><span class="line">                pag.press(key)</span><br><span class="line">                sleep(w_time)</span><br><span class="line">            f = time() - e</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;完成。用时%f秒。&#x27;</span> % f,FOREGROUND_SKYBLUE)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;没有这个键.查询key_all列表了解支持按键.&#x27;</span>,FOREGROUND_RED)</span><br><span class="line">        system(<span class="string">&#x27;pause&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>颜色：(color.py)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes,sys</span><br><span class="line"></span><br><span class="line">STD_INPUT_HANDLE = -<span class="number">10</span></span><br><span class="line">STD_OUTPUT_HANDLE = -<span class="number">11</span></span><br><span class="line">STD_ERROR_HANDLE = -<span class="number">12</span></span><br><span class="line"></span><br><span class="line">FOREGROUND_BLACK = <span class="number">0x00</span> <span class="comment"># black.</span></span><br><span class="line">FOREGROUND_DARKBLUE = <span class="number">0x01</span> <span class="comment"># dark blue.</span></span><br><span class="line">FOREGROUND_DARKGREEN = <span class="number">0x02</span> <span class="comment"># dark green.</span></span><br><span class="line">FOREGROUND_DARKSKYBLUE = <span class="number">0x03</span> <span class="comment"># dark skyblue.</span></span><br><span class="line">FOREGROUND_DARKRED = <span class="number">0x04</span> <span class="comment"># dark red.</span></span><br><span class="line">FOREGROUND_DARKPINK = <span class="number">0x05</span> <span class="comment"># dark pink.</span></span><br><span class="line">FOREGROUND_DARKYELLOW = <span class="number">0x06</span> <span class="comment"># dark yellow.</span></span><br><span class="line">FOREGROUND_DARKWHITE = <span class="number">0x07</span> <span class="comment"># dark white.</span></span><br><span class="line">FOREGROUND_DARKGRAY = <span class="number">0x08</span> <span class="comment"># dark gray.</span></span><br><span class="line">FOREGROUND_BLUE = <span class="number">0x09</span> <span class="comment"># blue.</span></span><br><span class="line">FOREGROUND_GREEN = <span class="number">0x0a</span> <span class="comment"># green.</span></span><br><span class="line">FOREGROUND_SKYBLUE = <span class="number">0x0b</span> <span class="comment"># skyblue.</span></span><br><span class="line">FOREGROUND_RED = <span class="number">0x0c</span> <span class="comment"># red.</span></span><br><span class="line">FOREGROUND_PINK = <span class="number">0x0d</span> <span class="comment"># pink.</span></span><br><span class="line">FOREGROUND_YELLOW = <span class="number">0x0e</span> <span class="comment"># yellow.</span></span><br><span class="line">FOREGROUND_WHITE = <span class="number">0x0f</span> <span class="comment"># white.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows CMD命令行 背景颜色定义 background colors</span></span><br><span class="line">BACKGROUND_BLUE = <span class="number">0x10</span> <span class="comment"># dark blue.</span></span><br><span class="line">BACKGROUND_GREEN = <span class="number">0x20</span> <span class="comment"># dark green.</span></span><br><span class="line">BACKGROUND_DARKSKYBLUE = <span class="number">0x30</span> <span class="comment"># dark skyblue.</span></span><br><span class="line">BACKGROUND_DARKRED = <span class="number">0x40</span> <span class="comment"># dark red.</span></span><br><span class="line">BACKGROUND_DARKPINK = <span class="number">0x50</span> <span class="comment"># dark pink.</span></span><br><span class="line">BACKGROUND_DARKYELLOW = <span class="number">0x60</span> <span class="comment"># dark yellow.</span></span><br><span class="line">BACKGROUND_DARKWHITE = <span class="number">0x70</span> <span class="comment"># dark white.</span></span><br><span class="line">BACKGROUND_DARKGRAY = <span class="number">0x80</span> <span class="comment"># dark gray.</span></span><br><span class="line">BACKGROUND_BLUE = <span class="number">0x90</span> <span class="comment"># blue.</span></span><br><span class="line">BACKGROUND_GREEN = <span class="number">0xa0</span> <span class="comment"># green.</span></span><br><span class="line">BACKGROUND_SKYBLUE = <span class="number">0xb0</span> <span class="comment"># skyblue.</span></span><br><span class="line">BACKGROUND_RED = <span class="number">0xc0</span> <span class="comment"># red.</span></span><br><span class="line">BACKGROUND_PINK = <span class="number">0xd0</span> <span class="comment"># pink.</span></span><br><span class="line">BACKGROUND_YELLOW = <span class="number">0xe0</span> <span class="comment"># yellow.</span></span><br><span class="line">BACKGROUND_WHITE = <span class="number">0xf0</span> <span class="comment"># white.</span></span><br><span class="line"></span><br><span class="line">_foreground_=[<span class="string">&#x27;FOREGROUND_BLACK&#x27;</span>,<span class="string">&#x27;FOREGROUND_DARKBLUE&#x27;</span>,<span class="string">&#x27;FOREGROUND_DARKGREEN&#x27;</span>,<span class="string">&#x27;FOREGROUND_DARKSKYBLUE&#x27;</span>,<span class="string">&#x27;FOREGROUND_DARKRED&#x27;</span>,<span class="string">&#x27;FOREGROUND_DARKPINK&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;FOREGROUND_DARKYELLOW&#x27;</span>,<span class="string">&#x27;FOREGROUND_DARKWHITE&#x27;</span>,<span class="string">&#x27;FOREGROUND_DARKGRAY&#x27;</span>,<span class="string">&#x27;FOREGROUND_BLUE&#x27;</span>,<span class="string">&#x27;FOREGROUND_GREEN&#x27;</span>,<span class="string">&#x27;FOREGROUND_SKYBLUE&#x27;</span>,<span class="string">&#x27;FOREGROUND_RED&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;FOREGROUND_PINK&#x27;</span>,<span class="string">&#x27;FOREGROUND_YELLOW&#x27;</span>,<span class="string">&#x27;FOREGROUND_WHITE&#x27;</span>]</span><br><span class="line">_background_=[<span class="string">&#x27;NONE&#x27;</span>,<span class="string">&#x27;BACKGROUND_BLUE&#x27;</span>,<span class="string">&#x27;BACKGROUND_GREEN&#x27;</span>,<span class="string">&#x27;BACKGROUND_DARKSKYBLUE&#x27;</span>,<span class="string">&#x27;BACKGROUND_DARKRED&#x27;</span>,<span class="string">&#x27;BACKGROUND_DARKPINK&#x27;</span>,<span class="string">&#x27;BACKGROUND_DARKYELLOW&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;BACKGROUND_DARKWHITE&#x27;</span>,<span class="string">&#x27;BACKGROUND_DARKGRAY&#x27;</span>,<span class="string">&#x27;BACKGROUND_SKYBLUE&#x27;</span>,<span class="string">&#x27;BACKGROUND_RED&#x27;</span>,<span class="string">&#x27;BACKGROUND_PINK&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;BACKGROUND_YELLOW&#x27;</span>,<span class="string">&#x27;BACKGROUND_WHITE&#x27;</span>]</span><br><span class="line">foreground=[FOREGROUND_BLACK,FOREGROUND_DARKBLUE,FOREGROUND_DARKGREEN,FOREGROUND_DARKSKYBLUE,FOREGROUND_DARKRED,FOREGROUND_DARKPINK,</span><br><span class="line">FOREGROUND_DARKYELLOW,FOREGROUND_DARKWHITE,FOREGROUND_DARKGRAY,FOREGROUND_BLUE,FOREGROUND_GREEN,FOREGROUND_SKYBLUE,FOREGROUND_RED,</span><br><span class="line">FOREGROUND_PINK,FOREGROUND_YELLOW,FOREGROUND_WHITE]</span><br><span class="line">background=[<span class="literal">None</span>,BACKGROUND_BLUE,BACKGROUND_GREEN,BACKGROUND_DARKSKYBLUE,BACKGROUND_DARKRED,BACKGROUND_DARKPINK,BACKGROUND_DARKYELLOW,</span><br><span class="line">BACKGROUND_DARKWHITE,BACKGROUND_DARKGRAY,BACKGROUND_SKYBLUE,BACKGROUND_RED,BACKGROUND_PINK,BACKGROUND_YELLOW,</span><br><span class="line">BACKGROUND_WHITE]</span><br><span class="line"></span><br><span class="line">__version__ = <span class="string">&quot;0.3.1&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">std_out_handle = ctypes.windll.kernel32.GetStdHandle(STD_OUTPUT_HANDLE)</span><br><span class="line">std_out_error = ctypes.windll.kernel32.GetStdHandle(STD_ERROR_HANDLE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_cmd_text_color</span>(<span class="params">color, handle=std_out_handle</span>):</span><br><span class="line">    Bool = ctypes.windll.kernel32.SetConsoleTextAttribute(handle, color)</span><br><span class="line">    <span class="keyword">return</span> Bool</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resetColor</span>():</span><br><span class="line">    set_cmd_text_color(FOREGROUND_RED | FOREGROUND_GREEN | FOREGROUND_BLUE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print</span>(<span class="params">mess=<span class="string">&#x27;&#x27;</span>,color=FOREGROUND_WHITE,bg=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> bg==<span class="literal">None</span>:</span><br><span class="line">        set_cmd_text_color(color)</span><br><span class="line">        sys.stdout.write(<span class="built_in">str</span>(mess) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        set_cmd_text_color(color|bg)</span><br><span class="line">        sys.stdout.write(<span class="built_in">str</span>(mess))</span><br><span class="line">        set_cmd_text_color(color)</span><br><span class="line">        sys.stdout.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    resetColor()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">from</span> os <span class="keyword">import</span> system</span><br><span class="line">    <span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(background)):</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(foreground)):</span><br><span class="line">            <span class="built_in">print</span>(_background_[i]+<span class="string">&#x27;+&#x27;</span>+_foreground_[f],foreground[f],background[i])</span><br><span class="line">            sleep(<span class="number">0.05</span>)</span><br><span class="line">    system(<span class="string">&#x27;pause&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>调用：(diaoyong.py)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> liandian <span class="keyword">import</span> *</span><br><span class="line">ld=api()</span><br><span class="line">ld.key(<span class="number">10</span>,<span class="string">&#x27;1&#x27;</span>,<span class="number">0.1</span>)<span class="comment">#次数 按键 等待时间</span></span><br><span class="line">ld.mouse(<span class="number">10</span>,<span class="number">0</span>,<span class="number">0</span>)<span class="comment">#次数 左键请输入0,右键输入1 等待时间</span></span><br></pre></td></tr></table></figure>

<p>使用时按上面调用文件进行修改</p>
<p>下一篇文章用tkinter把他包装一下</p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>教程</tag>
      </tags>
  </entry>
  <entry>
    <title>建站成功啦！</title>
    <url>/2023/02/06/%E5%BB%BA%E7%AB%99%E6%88%90%E5%8A%9F%E5%95%A6%EF%BC%81/</url>
    <content><![CDATA[<p>建站成功啦！<br>以后我会在这里发许多关于python与html相关的教程。</p>
<p>论坛链接<a href="http://110.87.103.126:9999/" title="110.87.103.126:9999&#x2F;" target="">110.87.103.126:9999&#x2F;</a></p>
<p>微信：royi123456f</p>
]]></content>
      <categories>
        <category>建站</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>Hexo</tag>
        <tag>Butterfly</tag>
        <tag>微信</tag>
        <tag>html</tag>
      </tags>
  </entry>
</search>
